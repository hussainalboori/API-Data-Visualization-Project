<!DOCTYPE html>
<html lang="en-US">

<head>
  <link rel="stylesheet" type="text/css" href="/static/artist.css">
</head>

<body>
  <style>
    body {
      background-color: #76576c;
      font-family: monospace
    }
  </style>
  <a class="home" href="/"></a>
  <div class="container">
    <div class="main">
      <div class="bio">
        <h1>{{.Main.Name}}</h1>
        <p>Created: </p><a>{{.Main.CreationDate}}</a>
        <p>First album released:</p> <a>{{.Main.FirstAlbum}}</a>
        <ul class="members">
          <p>Members:</p>
          {{range .Main.Members}}
          <li class="member">{{.}}</li>
          {{end}}
        </ul>
      </div>
      <div class="logo">
        <div class="image">
          <img src="{{.Main.Image}}" alt="artist's image" width="80%">
        </div>
      </div>
    </div>
    <div class="Concerts">
      <div class="tb">
        <table class="tab">
          <thead>
            <tr>
              <th>Location</th>
              <th>Date of concert</th>
            </tr>
          </thead>
          {{range $key, $value := .Concerts}}
          <tbody>
            <tr>
              <td>{{$key}}</td>
              <td>
                {{range $value}}
                <p class="date">{{.}}</p>
                {{end}}
              </td>

            </tr>
            <tr>
              <td>
                <div id="googleMap{{$key}}" style="width:100%;height:400px;"></div>
              </td>
            </tr>
          </tbody>
          {{end}}
        </table>
        <div id="googleMap" style="width:100%;height:400px;"></div>
      </div>
    </div>
  </div>
</body>
<script>
  function myMap() {
    var mainMap = new google.maps.Map(document.getElementById("googleMap"), {
      center: new google.maps.LatLng(0, 0),
      zoom: 1,
    });
    {{range $key, $value := .Concerts}}
    var geocoder = new google.maps.Geocoder();
    geocoder.geocode({ address: "{{ $key }}" }, function (results, status) {
      if (status === 'OK') {
        var myLatLng = results[0].geometry.location;

        var map = new google.maps.Map(document.getElementById("googleMap{{$key}}"), {
          center: myLatLng,
          zoom: 8,
        });

        var marker = new google.maps.Marker({
          position: myLatLng,
          map: map,
          title: '{{$key}}',
        });
        var marker2 = new google.maps.Marker({
          position: myLatLng,
          map: mainMap,
          title: '{{$key}} {{$value}}',
        });

      } else {
        var mapProp = {
          center: new google.maps.LatLng(51.508742, -0.120850),
          zoom: 8,
        };

        var map = new google.maps.Map(document.getElementById("googleMap{{$key}}"), mapProp);

      }

    });
    {{ end }}
  }
</script>

<script
  src="https://maps.googleapis.com/maps/api/js?key=AIzaSyC_79pmmv_C3K9YAYF5loywRcHiDRF7kRo&callback=myMap"></script>
</html>